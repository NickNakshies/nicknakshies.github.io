<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Layout</title>
    
    <!-- Poppins Font-->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- BootStrap-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
    
    <!--CSS natin-->
    <link rel="stylesheet" href="../Cart/cart.css">
    <link rel="stylesheet" href="../style.css">
    
    
    <!--BoxIcon natin-->
    <link rel="stylesheet" href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css">

    <!-- JS -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <script>document.addEventListener("DOMContentLoaded", function() {
        if (localStorage.getItem("isLoggedIn") !== "true") {
            window.location.href = "/pages/Sign_In_Up/signin.html";  // Redirect to login page
        }
    });</script>
</head>

<body>
    <div class="main-window">
        <!-- NAVBAR START -->
        <nav class="navbar navbar-expand-lg navbar-light bg-light px-4 mt-0 ms-3">
            <a class="navbar-brand" href="../../Boilerplate/index.html">
                <img src="../../assets/Logo.png" alt="Logo" >
            </a>

            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent"
                aria-controls="navbarContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <!-- Navbar content -->
            <div class="collapse navbar-collapse" id="navbarContent">

                <ul class="navbar-nav me-auto mb-2 mb-lg-0 ms-0 mt-2">
                    <li class="nav-item fs-3 me-5 ms-4">
                        <a class="nav-link fw-bold" href="/pages/Store/store.html#navbarContent">Featured</a>
                    </li>

                    <li class="nav-item dropdown fs-3 ms-4 me-2">
                        <a class="nav-link dropdown-toggle" href="#" id="storeDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            Store
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="storeDropdown">
                            <li><a class="dropdown-item" href="/pages/Store/store.html#item-boxes">Item Boxes</a></li>
                            <li><a class="dropdown-item" href="../../pages/Store/store.html#Poke-coins">Poke Coins</a></li>
                            <li><a class="dropdown-item" href="../Store/store.html#Daily-bundles">Daily Bundles</a></li>
                        </ul>
                    </li>

                    <li class="nav-item fs-3 ms-4 me-2">
                        <a class="nav-link" href="#">About</a>
                    </li>
                </ul>


                <ul class="navbar-nav mb-2 mb-lg-0 me-5">
                    <li class="nav-item me-4 mt-1">
                        <a class="nav-link" href="#">
                            <i class="bi bi-cart-fill override-icon rounded-pill bg-primary px-5 py-1" style="font-size: 2.8rem;"></i>
                        </a>
                    </li>
                    <li class="nav-item me-3 mt-2">
                        <a class="nav-link" href="/pages/Past_Orders/orders.html">
                            <i class="bi bi-receipt override-icon rounded-pill bg-danger px-5 p-2"></i>
                        </a>
                    </li>
                    <li class="nav-item me-1">
                        <a class="nav-link" href="/pages/Profile/profile.html">
                            <div class="d-flex align-items-center rounded-pill mt-1 px-4 py-1 text-light fw-bold fs-5" style="gap: 10px; background-color: #cbdf72;">Profile
                                <i class="bi bi-person-circle fs-1 text-light"></i>
                            </div>
                        </a>   
                    </li>
                </ul>
            </div>
        </nav>
        
        

        <!-- CART CONTENT -->


        <section class="container-cart">
            <div class="nav-cart">
                <div class="nav-cart-1">
                    <p>Poké Cart</p>
                    <p id="nav-cart-count"> 1 Items</p> <!-- Update Cart Items in Nav -->
                
                </div>
                <div class="nav-cart-2">
                    <p>Order Summary</p>
                </div>
            </div>

 


        </section>



                <!-- POKE CART -->
        <div class="container-2">


            <!-- CART LAMAN ITO FOSHO -->
            <div class="poke-cart">

                <div class="poke-cart-nav">
                    <div> <p>Product Details</p></div>
                    <p class="quantity-label">Quantity</p>
                    <p>Price</p>
                    <p>Total</p>
                </div>


                <div class="product">

                    <div class="product-image">
                        <img src="../../assets/Max Revive.png" alt="">
                    </div>
    
                    <div class="product-details">
                        <h5>Max Revive</h5>
                        <h6><a href="">Remove</a></h6>
                    </div>

                    <div class="product-quantity">

                        <button><i class='bx bx-minus'></i></button>
                        <input type="text" value="1">
                        <button><i class='bx bx-plus'></i></button>
                    </div>

                    <div class="product-price">
                        <p>₱ 99</p>
                    </div>

                    <div class="product-total">
                        <p>₱ 99</p>
                    </div>
    
                </div>

            <div class="line">
                <hr>
            </div>



            <div id="cart-items"></div> <!-- Cart items will be dynamically inserted here -->

            <div class="remove-btn">
                <button>Remove</button>
            </div>
            <button onclick="clearCart()" class="clear-cart-btn">Clear Cart</button>


            </div>
            <div class="cart-summary">
                <div class="cart-header">
                    <div><p id="cart-header-items">Items 3</p></div> <!-- Dynamic "Items X" -->
                        <p id="cart-header-total">₱ 594</p> <!-- Update Cart Header Total -->
                </div>

                
                <div class="cart-section">
                    <label for="shipping"><p>Payment Method</p></label>
                    <select id="shipping">
                        <option value="" disabled selected hidden>Choose Payment</option>
                        <option>Gcash</option>
                        <option>PayPal</option>
                        <option>Card</option>
                    </select>



                </div>
                
                <div class="cart-section">
                    <label for="promo"><p>Promo Code</p></label>
                    <input type="text" id="promo" placeholder="Enter your code">
                    <button class="apply-btn">Apply</button>
                </div>

                <div class="cart-section">
                    <input type="text" class="total-cost" placeholder="TOTAL COST" disabled>
                </div>

                <button id="checkout-btn" class="checkout-btn">Checkout</button>

            </div>




        </div>











    </div>




















    <footer class="bg-light text-dark py-4">
        <div class="container text-center">
          
          <!-- Social Media Icons -->
          <div class="mb-3">
            <a href="#" class=" mx-3">
              <i class="bi bi-youtube text-dark" style="font-size: 1.5rem;"></i>
            </a>
            <a href="#" class=" mx-3 text-dark">
              <i class="bi bi-facebook" style="font-size: 1.5rem;"></i>
            </a>
            <a href="#" class=" mx-3">
              <i class="bi bi-instagram text-dark" style="font-size: 1.5rem;"></i>
            </a>
            <a href="#" class=" mx-3">
              <i class="bi bi-tiktok text-dark" style="font-size: 1.5rem;"></i>
            </a>
          </div>
      

          <!-- Disclaimer -->
          <div class="small fs-5">
            No copyright infringement intended.<br>
            For educational purposes only. <br>All rights reserved.
          </div>
          
        </div>
      </footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    
    <script>

        document.addEventListener("DOMContentLoaded", function () {
            let cart = JSON.parse(localStorage.getItem("cart")) || [];
        
            const cartContainer = document.getElementById("cart-items");
            const quantityInputs = document.querySelectorAll(".product-quantity input");
            const minusButtons = document.querySelectorAll(".product-quantity button:first-of-type");
            const plusButtons = document.querySelectorAll(".product-quantity button:last-of-type");
            const priceElements = document.querySelectorAll(".product-price p");
            const totalElements = document.querySelectorAll(".product-total p");
            const totalCostInput = document.querySelector(".total-cost");
            const cartHeaderTotal = document.getElementById("cart-header-total");
            const navCartCount = document.getElementById("nav-cart-count");
            const cartHeaderItems = document.getElementById("cart-header-items");
            const checkoutBtn = document.getElementById("checkout-btn");
        
            function updateTotal() {
                let grandTotal = 0;
                let totalItems = 0;
            
                if (!cart || cart.length === 0) { 
                    totalCostInput.value = "₱ 0"; 
                    cartHeaderTotal.textContent = "₱ 0"; 
                    navCartCount.textContent = "0"; 
                    cartHeaderItems.textContent = "Items 0";
                    return;
                }
            
                cart.forEach((item, index) => {
                    let quantity = item.quantity || 1;
                    let price = item.price || 0;
                    let total = quantity * price;
                    
                    let totalElements = document.querySelectorAll(".product-total p");
                    let quantityInputs = document.querySelectorAll(".product-quantity input");
            
                    if (totalElements[index] && quantityInputs[index]) {
                        totalElements[index].textContent = `₱ ${total}`;
                        quantityInputs[index].value = quantity;
                    }
            
                    grandTotal += total;
                    totalItems += quantity;
                });
            
                totalCostInput.value = `₱ ${grandTotal}`;
                cartHeaderTotal.textContent = `₱ ${grandTotal}`;
                navCartCount.textContent = `${totalItems}`;
                cartHeaderItems.textContent = `Items ${totalItems}`;
            }
        
            minusButtons.forEach((btn, index) => {
                btn.addEventListener("click", function () {
                    let quantity = parseInt(quantityInputs[index].value);
                    if (quantity > 1) {
                        quantityInputs[index].value = quantity - 1;
                        updateTotal();
                    }
                });
            });
        
            plusButtons.forEach((btn, index) => {
                btn.addEventListener("click", function () {
                    let quantity = parseInt(quantityInputs[index].value);
                    quantityInputs[index].value = quantity + 1;
                    updateTotal();
                });
            });
        
            function renderCart() {
                const cartContainer = document.querySelector(".poke-cart");
            
                // Keep the cart header visible
                cartContainer.innerHTML = `
                    <div class="poke-cart-nav">
                        <div><p>Product Details</p></div>
                        <p>Quantity</p>
                        <p>Price</p>
                        <p>Total</p>
                    </div>
                `;
            
                if (cart.length === 0) {
                    cartContainer.innerHTML += `
                        <div class="empty-cart">
                            <p style="text-align: center; padding-top: 20px;font-size: 30px; color: #888;">Your cart is empty!</p>
                        </div>
                    `;
                    return;
                }
            
                cart.forEach((item, index) => {
                    let cartItemHTML = `
                        <div class="product">
                            <div class="product-image">
                                <img src="${item.image}" alt="${item.name}">
                            </div>
            
                            <div class="product-details">
                                <h5>${item.name}</h5>
                                <h6><a href="#" class="remove-btn" data-index="${index}">Remove</a></h6>
                            </div>
            
                            <div class="product-quantity">
                                <button class="minus-btn" data-index="${index}"><i class='bx bx-minus'></i></button>
                                <input type="text" value="${item.quantity}" class="quantity-input" data-index="${index}">
                                <button class="plus-btn" data-index="${index}"><i class='bx bx-plus'></i></button>
                            </div>
            
                            <div class="product-price">
                                <p>₱ ${item.price}</p>
                            </div>
            
                            <div class="product-total" >
                                <p>₱ ${item.price * item.quantity}</p>
                            </div>
                        </div>
                        <div class="line"><hr></div>
                    `;
                    cartContainer.innerHTML += cartItemHTML;
                });
            
                // Reattach event listeners for remove buttons
                document.querySelectorAll(".remove-btn").forEach(button => {
                    button.addEventListener("click", function (event) {
                        event.preventDefault();
                        let index = this.getAttribute("data-index");
                        removeFromCart(index);
                    });
                });
            
                // Reattach event listeners for quantity buttons
                document.querySelectorAll(".minus-btn").forEach(button => {
                    button.addEventListener("click", function () {
                        let index = this.getAttribute("data-index");
                        updateQuantity(index, -1);
                    });
                });
            
                document.querySelectorAll(".plus-btn").forEach(button => {
                    button.addEventListener("click", function () {
                        let index = this.getAttribute("data-index");
                        updateQuantity(index, 1);
                    });
                });
            }
            
            // Function to update the quantity
            function updateQuantity(index, change) {
                let quantityInput = document.querySelector(`.quantity-input[data-index="${index}"]`);
                
                let quantity = parseInt(quantityInput.value);
                if (quantity + change > 0) {
                    quantity += change;
                    cart[index].quantity = quantity;
                    quantityInput.value = quantity;
                    localStorage.setItem("cart", JSON.stringify(cart));
                    updateTotal();
                }
            }
        
            function removeFromCart(index) {
                cart.splice(index, 1);
                localStorage.setItem("cart", JSON.stringify(cart));
                renderCart(); // Ensures new indexes are assigned correctly
                updateTotal();
            }

            function clearCart() {
                localStorage.removeItem("cart");
                cart = []; // Reset cart array
                renderCart();
                updateTotal();
            }
        
            if (checkoutBtn) {
                checkoutBtn.addEventListener("click", function (event) {
                    event.preventDefault();
        
                    Swal.fire({
                        title: "Thank you for your order!",
                        text: "Your order has been successfully processed and updated in your Pokémon GO app.",
                        icon: "success",
                        confirmButtonText: "Go to Store",
                        confirmButtonColor: "#91c7ff",
                        showCloseButton: true,
                        closeButtonHtml: "x"
                    }).then((result) => {
                        if (result.isConfirmed) {
                            clearCart();
                            window.location.href = "../Store/store.html";
                        }
                    });
                });
            } 
            renderCart();
            updateTotal();
        });
    </script>
    
</body>
</html>